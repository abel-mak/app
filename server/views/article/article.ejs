<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<title></title>
		<link rel=stylesheet href="/css/bootstrap.min.css">
		<link rel=stylesheet href="/css/index.css">
		<link rel=stylesheet href="/css/article.css">
		<link rel="stylesheet" 
		href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" 
		integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" 
		crossorigin="anonymous"/>
	</head>
	<body>
		<%- include('../components/header.ejs', {user, error, success}) %>
		<div class="container" style="background: #9b95a036;">
		<!--	<% for(let i = 0; i < data.length; i++){%>
			<div class="article_container">
				<div class="data">
					<div class="title"><h2><%= data[i].title %></h2></div>
					<div class="body"><%= data[i].body %></div>
				</div>
				<div class="article-meta">
					<span>points</span>
					<span>comments</span>
				</div>
			</div>
			<% } %> -->
			<% for(let i = 0; i < data.length; i++){%>
				<%- include("../components/articleContent", 
				{
					id: data[i].id, 
					title: data[i].title,
					body: data[i].body,
					vote:data[i].vote,
					user_vote:data[i].user_vote
					}) %>
			<% } %>
			<style>
				.shadow
				{
					color:black;
				}
			</style>
			<script>
				const btn = document.querySelector(".container");
		 		document.querySelectorAll('.vote-elem').forEach(item => 
		 		{
		 				item.addEventListener("click", (e) =>
		 				{
		 					const tmpData = e.currentTarget.dataset.id;	
		 				
		 				    vote = tmpData.split("_")[0];
		 				    article_id = tmpData.split("_")[1];
		 				    console.log(`article/id=${article_id}/${vote}`);
		 				    	fetch(`article/id=${article_id}/${vote}`, {method:"POST"})
		 				    .then(res => 
		 				    	{
		 						
		 				    	//	if (res.status != 200)
		 				    	//		window.location.reload();
		 				    		return res.json();
		 				    	})
		 				    .then(res => console.log(res));
		 				})
		 		   
		 		})
			</script>
	</body>
</html>
